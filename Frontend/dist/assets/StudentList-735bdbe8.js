import{i as $,u as I,k as q,r as i,l as O,j as e,L as R,B as s,D as G,g,P as H,E as J,S as K,T as f,m as Q,n as U,M as p,f as u,o as V,p as W,q as X}from"./index-bb1089d4.js";const Z=()=>{const{actions:c}=$(),{data:y,loading:S,error:m,refetch:x}=I("student"),{remove:N,loading:h}=q("student"),[n,v]=i.useState([]),[l,r]=i.useState({open:!1,student:null}),[b,d]=i.useState(!1),{data:C,currentPage:k,totalPages:w,totalItems:D,pageSize:_,searchTerm:o,handlePageChange:P,handlePageSizeChange:E,handleSearch:j,handleSort:M,sortField:z,sortDirection:A}=O(y||[],10),T=["first_name","last_name","email","student_id"];i.useEffect(()=>{j(o,T)},[o]);const B=async t=>{const a=await N(t.student_id);a.success?(c.showSuccess("Student deleted successfully"),x(),r({open:!1,student:null})):c.showError(a.error||"Failed to delete student")},L=async()=>{d(!1),v([]),c.showSuccess(`${n.length} students deleted successfully`)},F=[{key:"student_id",label:"Student ID",sortable:!0},{key:"name",label:"Name",sortable:!0,render:(t,a)=>u.formatName(a.first_name,a.last_name)},{key:"email",label:"Email",sortable:!0},{key:"dob",label:"Date of Birth",sortable:!0,render:t=>u.formatDate(t)},{key:"department_id",label:"Department",render:t=>`Dept ${t}`},{key:"course_id",label:"Course",render:t=>`Course ${t}`},{key:"actions",label:"Actions",render:(t,a)=>e.jsxs(V,{children:[e.jsx(s,{variant:"ghost",size:"sm",onClick:()=>{},children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx(g,{to:`/students/${a.student_id}/edit`,children:e.jsx(s,{variant:"ghost",size:"sm",children:e.jsx(X,{className:"h-4 w-4"})})}),e.jsx(s,{variant:"ghost",size:"sm",onClick:()=>r({open:!0,student:a}),className:"text-red-600 hover:text-red-700",children:e.jsx(f,{className:"h-4 w-4"})})]})}];return S?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(R,{size:"lg",text:"Loading students..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"md:flex md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:"Students"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage student records and information"})]}),e.jsxs("div",{className:"mt-4 flex space-x-3 md:mt-0 md:ml-4",children:[e.jsxs(s,{variant:"outline",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsx(g,{to:"/students/new",children:e.jsxs(s,{variant:"primary",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Add Student"]})})]})]}),m&&e.jsx(J,{message:m,onClose:()=>x()}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsx(K,{placeholder:"Search students by name, email, or ID...",value:o,onChange:j,className:"sm:max-w-xs"}),n.length>0&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-sm text-gray-700",children:[n.length," selected"]}),e.jsxs(s,{variant:"danger",size:"sm",onClick:()=>d(!0),children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Delete Selected"]})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx(Q,{columns:F,data:C,sortField:z,sortDirection:A,onSort:M,emptyMessage:"No students found"}),e.jsx(U,{currentPage:k,totalPages:w,totalItems:D,pageSize:_,onPageChange:P,onPageSizeChange:E})]}),e.jsx(p,{isOpen:l.open,onClose:()=>r({open:!1,student:null}),title:"Delete Student",footer:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(s,{variant:"outline",onClick:()=>r({open:!1,student:null}),children:"Cancel"}),e.jsx(s,{variant:"danger",loading:h,onClick:()=>B(l.student),children:"Delete"})]}),children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete"," ",e.jsx("strong",{children:l.student&&u.formatName(l.student.first_name,l.student.last_name)}),"? This action cannot be undone."]})}),e.jsx(p,{isOpen:b,onClose:()=>d(!1),title:"Delete Multiple Students",footer:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(s,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsxs(s,{variant:"danger",loading:h,onClick:L,children:["Delete ",n.length," Students"]})]}),children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete ",n.length," selected students? This action cannot be undone."]})})]})};export{Z as default};
