import{i as O,u as p,k as R,r as c,l as G,j as e,L as H,B as s,D as J,g as f,P as K,E as Q,S as U,T as C,m as V,n as W,M as y,o as X,p as Y,q as Z}from"./index-bb1089d4.js";const se=()=>{var g;const{actions:o}=O(),{data:N,loading:v,error:x,refetch:m}=p("course"),{data:i}=p("department"),{remove:w,loading:h}=R("course"),[l,S]=c.useState([]),[d,n]=c.useState({open:!1,course:null}),[D,r]=c.useState(!1),{data:b,currentPage:k,totalPages:P,totalItems:_,pageSize:M,searchTerm:u,handlePageChange:z,handlePageSizeChange:E,handleSearch:j,handleSort:A,sortField:T,sortDirection:L}=G(N||[],10),B=["course_name","course_id"];c.useEffect(()=>{j(u,B)},[u]);const F=async a=>{const t=await w(a.course_id);t.success?(o.showSuccess("Course deleted successfully"),m(),n({open:!1,course:null})):o.showError(t.error||"Failed to delete course")},I=async()=>{r(!1),S([]),o.showSuccess(`${l.length} courses deleted successfully`)},$=(i==null?void 0:i.reduce((a,t)=>(a[t.dept_id]=t.dept_name,a),{}))||{},q=[{key:"course_id",label:"Course ID",sortable:!0},{key:"course_name",label:"Course Name",sortable:!0},{key:"department_id",label:"Department",sortable:!0,render:a=>$[a]||`Dept ${a}`},{key:"actions",label:"Actions",render:(a,t)=>e.jsxs(X,{children:[e.jsx(s,{variant:"ghost",size:"sm",onClick:()=>{},children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(f,{to:`/courses/${t.course_id}/edit`,children:e.jsx(s,{variant:"ghost",size:"sm",children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsx(s,{variant:"ghost",size:"sm",onClick:()=>n({open:!0,course:t}),className:"text-red-600 hover:text-red-700",children:e.jsx(C,{className:"h-4 w-4"})})]})}];return v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(H,{size:"lg",text:"Loading courses..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"md:flex md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:"Courses"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage course offerings and curriculum"})]}),e.jsxs("div",{className:"mt-4 flex space-x-3 md:mt-0 md:ml-4",children:[e.jsxs(s,{variant:"outline",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsx(f,{to:"/courses/new",children:e.jsxs(s,{variant:"primary",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Add Course"]})})]})]}),x&&e.jsx(Q,{message:x,onClose:()=>m()}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsx(U,{placeholder:"Search courses by name or ID...",value:u,onChange:j,className:"sm:max-w-xs"}),l.length>0&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-sm text-gray-700",children:[l.length," selected"]}),e.jsxs(s,{variant:"danger",size:"sm",onClick:()=>r(!0),children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Delete Selected"]})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx(V,{columns:q,data:b,sortField:T,sortDirection:L,onSort:A,emptyMessage:"No courses found"}),e.jsx(W,{currentPage:k,totalPages:P,totalItems:_,pageSize:M,onPageChange:z,onPageSizeChange:E})]}),e.jsx(y,{isOpen:d.open,onClose:()=>n({open:!1,course:null}),title:"Delete Course",footer:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(s,{variant:"outline",onClick:()=>n({open:!1,course:null}),children:"Cancel"}),e.jsx(s,{variant:"danger",loading:h,onClick:()=>F(d.course),children:"Delete"})]}),children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete"," ",e.jsx("strong",{children:(g=d.course)==null?void 0:g.course_name}),"? This action cannot be undone."]})}),e.jsx(y,{isOpen:D,onClose:()=>r(!1),title:"Delete Multiple Courses",footer:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(s,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsxs(s,{variant:"danger",loading:h,onClick:I,children:["Delete ",l.length," Courses"]})]}),children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete ",l.length," selected courses? This action cannot be undone."]})})]})};export{se as default};
