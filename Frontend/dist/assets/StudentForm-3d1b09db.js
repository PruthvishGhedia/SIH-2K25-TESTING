import{s as k,t as z,i as O,u as n,k as P,v as G,r as R,f as v,j as e,L as U,B as g,w as V,E as b,I as l,x as h,y as H,z as t}from"./index-bb1089d4.js";const Q=()=>{const o=k(),{id:c}=z(),r=!!c,{actions:u}=O(),{data:a,loading:y,error:j}=n("student",c),{data:m}=n("department"),{data:x}=n("course"),{data:p}=n("guardian"),{create:N,update:S,loading:q,error:f}=P("student"),w={first_name:[t.required,t.maxLength(50)],last_name:[t.required,t.maxLength(50)],email:[t.required,t.email],dob:[t.required,t.date,t.pastDate],department_id:[t.required],course_id:[t.required],guardian_id:[t.required]},{values:J,errors:K,isSubmitting:E,isValid:F,isDirty:L,handleSubmit:C,setFormValues:_,getFieldProps:i}=G({first_name:"",last_name:"",email:"",dob:"",department_id:"",course_id:"",guardian_id:""},w);R.useEffect(()=>{r&&a&&_({first_name:a.first_name||"",last_name:a.last_name||"",email:a.email||"",dob:v.formatDateForInput(a.dob)||"",department_id:a.department_id||"",course_id:a.course_id||"",guardian_id:a.guardian_id||""})},[r,a,_]);const A=async s=>{try{let d;r?d=await S(c,s):d=await N(s),d.success?(u.showSuccess(r?"Student updated successfully":"Student created successfully"),o("/students")):u.showError(d.error||"Failed to save student")}catch{u.showError("An unexpected error occurred")}},I=(m==null?void 0:m.map(s=>({value:s.dept_id,label:s.dept_name})))||[],D=(x==null?void 0:x.map(s=>({value:s.course_id,label:s.course_name})))||[],B=(p==null?void 0:p.map(s=>({value:s.guardian_id,label:v.formatName(s.first_name,s.last_name)})))||[];return y?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(U,{size:"lg",text:"Loading student..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"md:flex md:items-center md:justify-between",children:e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>o("/students"),children:e.jsx(V,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:r?"Edit Student":"Add New Student"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r?"Update student information":"Create a new student record"})]})]})})}),j&&e.jsx(b,{message:j}),f&&e.jsx(b,{message:f}),e.jsx("form",{onSubmit:s=>{s.preventDefault(),C(A)},children:e.jsxs("div",{className:"card p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[e.jsx(l,{label:"First Name",required:!0,...i("first_name")}),e.jsx(l,{label:"Last Name",required:!0,...i("last_name")}),e.jsx(l,{label:"Email",type:"email",required:!0,...i("email")}),e.jsx(l,{label:"Date of Birth",type:"date",required:!0,...i("dob")})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Academic Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[e.jsx(h,{label:"Department",required:!0,options:I,placeholder:"Select a department",...i("department_id")}),e.jsx(h,{label:"Course",required:!0,options:D,placeholder:"Select a course",...i("course_id")})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Guardian Information"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:e.jsx(h,{label:"Guardian",required:!0,options:B,placeholder:"Select a guardian",...i("guardian_id")})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>o("/students"),children:"Cancel"}),e.jsxs(g,{type:"submit",variant:"primary",loading:E||q,disabled:!F||!L&&r,children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),r?"Update Student":"Create Student"]})]})]})})]})};export{Q as default};
